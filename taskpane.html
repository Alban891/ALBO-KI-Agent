<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ALBO KI-Finance-Agent</title>
    
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body style="font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f0f2f5;">
    
    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        
        <!-- Header -->
        <div style="text-align: center; margin-bottom: 20px;">
            <h1 style="color: #333; margin: 0;">ü§ñ ALBO KI-Agent</h1>
            <p style="color: #666; margin: 5px 0;">Finance-Automatisierung</p>
        </div>
        
        <!-- Status -->
        <div id="status" style="padding: 10px; border-radius: 5px; text-align: center; background: #d4edda; color: #155724; margin-bottom: 20px;">
            Add-In erfolgreich geladen!
        </div>
        
        <!-- Agents -->
        <div style="margin-bottom: 20px;">
            <h3 style="color: #333;">KI-Agent ausw√§hlen:</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button onclick="selectAgent('finance')" id="btn-finance" style="padding: 15px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer;">
                    üí∞ Finance Expert
                </button>
                <button onclick="selectAgent('business')" id="btn-business" style="padding: 15px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer;">
                    üìä Business Assistant
                </button>
                <button onclick="selectAgent('content')" id="btn-content" style="padding: 15px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer;">
                    ‚úçÔ∏è Content Writer
                </button>
                <button onclick="selectAgent('data')" id="btn-data" style="padding: 15px; border: 2px solid #ddd; border-radius: 8px; background: white; cursor: pointer;">
                    üìà Data Analyst
                </button>
            </div>
        </div>
        
        <!-- Actions -->
        <div style="margin-bottom: 20px;">
            <button onclick="processEmail('auto')" style="width: 100%; padding: 12px; margin-bottom: 8px; border: none; border-radius: 6px; background: #28a745; color: white; cursor: pointer; font-size: 14px;">
                ‚ö° Vollst√§ndig automatisch
            </button>
            <button onclick="processEmail('draft')" style="width: 100%; padding: 12px; margin-bottom: 8px; border: none; border-radius: 6px; background: #007bff; color: white; cursor: pointer; font-size: 14px;">
                üìù Als Entwurf speichern
            </button>
            <button onclick="processEmail('review')" style="width: 100%; padding: 12px; margin-bottom: 8px; border: none; border-radius: 6px; background: #ffc107; color: black; cursor: pointer; font-size: 14px;">
                üîç √úberdenken & Entwurf
            </button>
        </div>
        
        <!-- Email Preview -->
        <div id="emailPreview" style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 15px;">
            <h4 style="margin: 0 0 10px 0;">üìß Demo E-Mail:</h4>
            <div style="font-size: 12px; color: #666;">
                Betreff: Mahnung - Rechnung Nr. 2024-001<br><br>
                Sehr geehrte Damen und Herren,<br>
                anbei erhalten Sie die Rechnung Nr. 2024-001 √ºber 1.500,00 EUR...
            </div>
        </div>
        
        <!-- AI Response -->
        <div id="aiResponse" style="padding: 15px; background: #e3f2fd; border-radius: 8px; display: none;">
            <h4 style="margin: 0 0 10px 0;">ü§ñ KI-Analyse:</h4>
            <div id="responseContent"></div>
        </div>
        
    </div>

    <script>
        var selectedAgent = '';
        
        // Office.js bereit
        Office.onReady(function() {
            console.log('Office Add-In geladen');
            updateStatus('‚úÖ Office Add-In bereit!', 'success');
        });
        
        // Agent ausw√§hlen
        function selectAgent(agentType) {
            selectedAgent = agentType;
            
            // Reset alle Buttons
            document.getElementById('btn-finance').style.background = 'white';
            document.getElementById('btn-business').style.background = 'white';
            document.getElementById('btn-content').style.background = 'white';
            document.getElementById('btn-data').style.background = 'white';
            
            // Markiere gew√§hlten Agent
            document.getElementById('btn-' + agentType).style.background = '#007bff';
            document.getElementById('btn-' + agentType).style.color = 'white';
            
            updateStatus('Agent "' + agentType + '" ausgew√§hlt', 'success');
            console.log('Agent gew√§hlt:', agentType);
        }
        
        // E-Mail verarbeiten
        function processEmail(actionType) {
            if (!selectedAgent) {
                updateStatus('‚ùå Bitte w√§hlen Sie zuerst einen Agent aus', 'error');
                return;
            }
            
            updateStatus('ü§ñ Agent verarbeitet E-Mail...', 'loading');
            console.log('Verarbeite mit Agent:', selectedAgent, 'Action:', actionType);
            
            // Simulation
            setTimeout(function() {
                showAIResponse(selectedAgent, actionType);
                updateStatus('‚úÖ Verarbeitung abgeschlossen', 'success');
            }, 2000);
        }
        
        // AI Response anzeigen
        function showAIResponse(agent, action) {
            var responseDiv = document.getElementById('aiResponse');
            var content = document.getElementById('responseContent');
            
            var responses = {
                'finance': 'Finanzielle E-Mail analysiert. Rechnung erkannt, Zahlungsziel identifiziert.',
                'business': 'Gesch√§fts-E-Mail klassifiziert. Standard-Workflow anwendbar.',
                'content': 'Text optimiert. Stil verbessert, Grammatik korrigiert.',
                'data': 'Datenanalyse abgeschlossen. Trends erkannt, KPIs extrahiert.'
            };
            
            content.innerHTML = '<strong>Analyse:</strong> ' + responses[agent] + '<br><br>' +
                               '<strong>Aktion:</strong> ' + action + '<br><br>' +
                               '<strong>Antwort:</strong> Vielen Dank f√ºr Ihre Nachricht. Wir haben Ihre Anfrage bearbeitet.';
            
            responseDiv.style.display = 'block';
        }
        
        // Status Update
        function updateStatus(message, type) {
            var statusDiv = document.getElementById('status');
            
            if (type === 'success') {
                statusDiv.style.background = '#d4edda';
                statusDiv.style.color = '#155724';
            } else if (type === 'error') {
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.color = '#721c24';
            } else if (type === 'loading') {
                statusDiv.style.background = '#d1ecf1';
                statusDiv.style.color = '#0c5460';
            }
            
            statusDiv.innerHTML = message;
            console.log('Status:', message);
        }
        
        console.log('ALBO KI-Agent Script geladen');
    </script>

</body>
</html>
